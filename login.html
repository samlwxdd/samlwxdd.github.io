<!DOCTYPE html>
<html lang="en">
<head>

  <!-- Website initialization -->
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- jQuery Library -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

  <!-- MaterializeCSS -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.css">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.js"></script>

  <!-- Tensorflow Machine Learning -->
  <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@1.3.1/dist/tf.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@teachablemachine/image@0.8/dist/teachablemachine-image.min.js"></script>

  <!-- Defining shortcut icon -->
  <link rel="shortcut icon" href="/images/icon.png">

  <!-- Font type -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300&display=swap" rel="stylesheet">

  <!-- Self-defined stylesheet -->
  <link href="/elements/style.css" rel="stylesheet">

  <!-- Warning for customers who did not enable JS -->
  <noscript>Your browser does not support JavaScript.
      Please enable it to enjoy the full feature of this website.</noscript>

  <!-- Inititializing elements in webpage -->
  <script>
  /* Initializing tabs */
  $(document).ready(function(){
      $('.tabs').tabs();
  });

  /* Initializing pop-up window */
  $(document).ready(function(){
      $('.modal').modal();
  });

  /* Size selection button */
  $(document).ready(function(){
      $('select').formSelect();
  });

  /* Initializing collapsible function */
  var elem = document.querySelector('.collapsible.expandable');
  var instance = M.Collapsible.init(elem, {
      accordion: false
  });

  /* Initializing navigation bar: Mobile version */
  document.addEventListener('DOMContentLoaded', function() {
      var elems = document.querySelectorAll('.sidenav');
      var instances = M.Sidenav.init(elems);
  });

  /* Initializing floating button on the right bottom corner */
  document.addEventListener('DOMContentLoaded', function() {
      var elems = document.querySelectorAll('.fixed-action-btn');
      var instances = M.FloatingActionButton.init(elems, {
      direction: 'left',
      hoverEnabled: false
      });
  });

  /* Add/Minus product quantity */
  $(document).ready(function() {
      $('.minus').click(function () {
          var $input = $(this).parent().parent().find('#quantity');
          var count = parseInt($input.val()) - 1;
          count = count < 1 ? 1 : count;
          $input.val(count);
          $input.change();

          var $output = $(this).parent().parent().find('#price');
          var price = $input.val() * 80;
          $output.val(price);
          $output.change();

          return false;
      });

      $('.plus').click(function () {
          var $input = $(this).parent().parent().find('#quantity');
          $input.val(parseInt($input.val()) + 1);
          $input.change();

          var $output = $(this).parent().parent().find('#price');
          var price = $input.val() * 80;
          $output.val(price);
          $output.change();

          return false;
      });
      });
  </script>
  <title>Login | Good1.com</title>
</head>

<body>

<!-- Top navigation bar: Desktop version -->
<nav>
  <div class="nav-wrapper">
    <a href="index.html" class="brand-logo"><img src="/images/logo.png" alt="Good1.com icon" height="60px"></a>
    <a href="#" data-target="mobile-demo" class="sidenav-trigger"><i class="material-icons" style="padding-left: 10px;">menu</i></a>
    <ul class="right hide-on-med-and-down">
      <li style="padding-right: 10px"> Hello: Visitor</li>
      <li><a href="index.html">Index</a></li>
      <li><a href="login.html">Login</a></li>
    </ul>
  </div>
</nav>

<!-- Top navigation bar: Mobile version -->
<ul class="sidenav" id="mobile-demo">
  <li style="padding: 0 25px">Hello: Visitor</li>
  <li><a href="index.html">Index</a></li>
  <li><a href="login.html">Login</a></li>
</ul>

<!-- Carousel (Promotional offers) -->
<div class="carousel carousel-slider center" style="height: 200px">
  <div class="carousel-fixed-item center">
    <a class="btn waves-effect white grey-text darken-text-2">Get this offer</a>
  </div>
  <div class="carousel-item red white-text" href="#one!">
    <h2>Promotion 1</h2>
    <p class="white-text">Buy real get one NFT (on Polygon Chain).</p>
  </div>
  <div class="carousel-item amber white-text" href="#two!">
    <h2>Promotion 2</h2>
    <p class="white-text">Free shipping to HKUST!</p>
  </div>
</div>

<br><br>

<!-- Login form -->
<div class="container row">
  <div class="col s12 l7">
    <h5>Login</h5>
    <form>
      <div class="row">
      <div class="input-field col l8" >
        <i class="material-icons prefix">person</i>
        <input id="username" type="text"></input>
        <label for="username">Username</label>
      </div>
        <div class="input-field col l8">
          <i class="material-icons prefix">password</i>
          <input id="password" type="password"></input>
        <label for="password">Password</label>
        </div>
      </div>
      <a class="btn waves-effect waves-light" name="action" href="login_index.html">Login
        <i class="material-icons right">login</i>
      </a>
    </form>
    <br>
  </div>

  <div class="col s12 l5">
    <h5>Login with crypto wallets</h5>
    Registration is not required.
    <br><br>
      <a id="metamask_btn" class="btn checkout-btn" style="background-color: #0091ea"><i class="material-icons left">wallet</i>Login with Metamask</a>
      <p id='metamask_address' class='text-lg text-gray-600 my-2'></p>
      <br>
      <h5>Not yet joined us?</h5>
      <a class="btn checkout-btn" style="background-color: #f9a825"><i class="material-icons left">how_to_reg</i>Register using email address</a>
  </div>

</div>

<!-- Floating button on the right bottom corner -->
<div class="fixed-action-btn">
  <a class="btn-floating btn-large red">
    <i class="large material-icons">question_mark</i>
  </a>
  <ul>
    <li><a class="btn-floating red" href="mailto:cs@good1.com"><i class="material-icons">email</i></a></li>
    <li><a class="btn-floating yellow darken-1" href="tel:+85212345678"><i class="material-icons">call</i></a></li>
  </ul>
</div>

<!-- Footer -->
<footer class="page-footer">
    <div class="container">
    <div class="row">
        <div class="col l6 s12">
        <h5 class="white-text">Good1.com</h5>
        <p class="grey-text text-lighten-4">This is some kind of random text describing Good1.com, a place for you to shop for good items.</p>
        </div>
        <div class="col l4 offset-l2 s12">
        <h5 class="white-text">Links</h5>
        <ul>
            <li><a class="grey-text text-lighten-3" href="login_index.html">Index</a></li>
            <li><a class="grey-text text-lighten-3" href="login.html">Login</a></li>
        </ul>
        </div>
    </div>
    </div>
    <div class="footer-copyright">
    <div class="container">
    Â© 2022 Good1.com
    </div>
    </div>
</footer>

<!-- Sign in with Metamask -->
<script>
  window.userWalletAddress = null
  const metamask_btn = document.getElementById('metamask_btn')
  const userWallet = document.getElementById('metamask_address')

  function toggleButton() {
    if (!window.ethereum) {
      metamask_btn.innerText = 'MetaMask is not installed.'
      metamask_btn.classList.remove('bg-purple-500', 'text-white')
      metamask_btn.classList.add('bg-gray-500', 'text-gray-100', 'cursor-not-allowed')
      return false
    }

    metamask_btn.addEventListener('click', loginWithMetaMask)
  }

  async function loginWithMetaMask() {
    const accounts = await window.ethereum.request({ method: 'eth_requestAccounts' })
      .catch((e) => {
        console.error(e.message)
        return
      })
    if (!accounts) { return }

    window.userWalletAddress = accounts[0]
    userWallet.innerText = window.userWalletAddress
    document.cookie = "metamask_address=" + window.userWalletAddress
    location.href = 'login_index.html'
    metamask_btn.innerText = 'Sign out of MetaMask'

    metamask_btn.removeEventListener('click', loginWithMetaMask)
    setTimeout(() => {
    metamask_btn.addEventListener('click', signOutOfMetaMask)
    }, 200)
  }

  function signOutOfMetaMask() {
    window.userWalletAddress = null
    userWallet.innerText = ''
    metamask_btn.innerText = 'Sign in with MetaMask'

    metamask_btn.removeEventListener('click', signOutOfMetaMask)
    setTimeout(() => {
    metamask_btn.addEventListener('click', loginWithMetaMask)
    }, 200)
  }

  window.addEventListener('DOMContentLoaded', () => {
    toggleButton()
  });
</script>

<!-- Inititializing elements in webpage -->
<script>
  /* Initializing tabs */
  $(document).ready(function(){
      $('.tabs').tabs();
  });
  
  /* Initializing pop-up window */
  $(document).ready(function(){
      $('.modal').modal();
  });
  
  /* Size selection button */
  $(document).ready(function(){
      $('select').formSelect();
  });
  
  /* Initializing collapsible function */
  var elem = document.querySelector('.collapsible.expandable');
  var instance = M.Collapsible.init(elem, {
      accordion: false
  });
  
  /* Initializing navigation bar: Mobile version */
  document.addEventListener('DOMContentLoaded', function() {
      var elems = document.querySelectorAll('.sidenav');
      var instances = M.Sidenav.init(elems);
  });
  
  /* Initializing floating button on the right bottom corner */
  document.addEventListener('DOMContentLoaded', function() {
      var elems = document.querySelectorAll('.fixed-action-btn');
      var instances = M.FloatingActionButton.init(elems, {
      direction: 'left',
      hoverEnabled: false
      });
  });
  
  /* Initializing carousel (promotional offers) */
  $('.carousel.carousel-slider').carousel({
      fullWidth: true
  });
  
  /* Add/Minus product quantity */
  $(document).ready(function() {
      $('.minus').click(function () {
          var $input = $(this).parent().parent().find('#quantity');
          var count = parseInt($input.val()) - 1;
          count = count < 1 ? 1 : count;
          $input.val(count);
          $input.change();
  
          var $output = $(this).parent().parent().find('#price');
          var price = $input.val() * 80;
          $output.val(price);
          $output.change();
  
          return false;
      });
  
      $('.plus').click(function () {
          var $input = $(this).parent().parent().find('#quantity');
          $input.val(parseInt($input.val()) + 1);
          $input.change();
  
          var $output = $(this).parent().parent().find('#price');
          var price = $input.val() * 80;
          $output.val(price);
          $output.change();
  
          return false;
      });
      });
</script>

</body>
</html>